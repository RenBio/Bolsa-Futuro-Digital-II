<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mini Loja</title>

    <link rel="stylesheet" href="./Estetica.css">

</head>

<body>
    <h1>Mini Loja</h1>
    <main id="pai">
        <div id="produto" class="box">
            <h1>Produtos</h1>
        <div id="camisa"> 
            <p>camisa</p>
            <p>preco</p>
            <button>adicionar</button>
        </div>
    </div>
    <div id="carrinho" class="box">
        <h1>carrinho</h1>
    </div>
    <div>

    </div>
    </main>





<script>
/* Lista de produtos*/    
let produtos = [
    {id:1, nome: "Camisa", preço: 200,},
    {id:2, nome: "Tênis",preço:120,},
    {id:3, nome: "livro", preço: 80,},

]
// carrinho vazio
let carrinho = [];

/*Função para converter os valores*/

function formatarPreco(value){
return value.toLocaleString("pt-br", {style:currency, currency: "BRL"});
}

// Função para mostrar os produtos na página
function mostrarProdutos(){
    let listaProdutos = document.getElementById("lista-Produtos");
listaProdutos.innerHTML = "";
}


let divCarrinho = document.getElementById("carrinho");

/*função para renderizar os produtos*/

function RenderizarProdutos(){
    for (var i = 0; i< produtos.length; i++){
        listaProdutos.innerHTML += '<div class = "produto">' + '<strong>' + produtos[i].nome +'</strong><br>' + formatarPreco(produtos[i].preco) + '<br>'
             + '<button onclick ="adicionarAoCarrinho"('+i+')>Adicionar</button>' + '</div>'
        }
    
    }


// Função para adicionar item ao carrinho.
function adicionarAoCarrinho(indiceProduto){
    let produto = produtos = [indiceProduto];
    carrinho.push(produto);
    atualizarCarrinho();

}
// Verifica se o produto já esta no carrinho
let produtoNoCarrinho = null;

for (let i = 0; i< carrinho.length; i++){
    if (carrinho[i].nome === produto.nome){
        produtoNoCarrinho = carrinho[i]; break; // Parar quando encontrar
    }
} 

if (produtoNoCarrinho){// Se já esta, aumenta a quantidade
    produtoNoCarrinho.quantidade++;
} else{//
    carrinho.push({//Se não esta, adiciona 1
        nome: produto.nome,
        preco:produto.preco,
        quantidade:1
    });
}
//Atualizar o carrinho
atualizarCarrinho();

/*Função para remover item do carrinho*/

function removerDoCarrinho(nomeProduto){ // Encontra produto no carrinho
    let produtoNoCarrinho = null;

    for (let i = 0; i < carrinho.length; i++){
        if (carrinho[i]. nome === nomeProduto) {produtoNoCarrinho = carrinho[i]; break

        }
    }
}

if (produtoNoCarrinho){ // Cria um novo carrinho sem o produto
    let novoCarrinho = [];
}

for (let i = 0; i < carrinho.length; i++){
    if (carrinho[i].nome ! == nomeProduto) {
        novoCarrinho.push(carrinho[i]);
    }
carrinho = novoCarrinho
    
}

// Atualiza a exibição do carrinho
atualizarCarrinho();

/* Função para atualizar a exibição do carrinho*/

let listaCarrinho = document.getElementById('listaCarrinho');
let totalElemento = document.getElementById('total');

// limpa lista do carrinho
listaCarrinho.innerHTML = "";

// Se o carrinho estiver vazio, mostra a mensagem
if (carrinho.length === 0) {
    listaCarrinho.innerHTML ='<p class="vazio">Carrinho Vazio</p>';
} else {
    for (let i = 0; i < carrinho.length; i++){
        let item = carrinho [i];
        let precoTotal = item.preco * item.quantidade;
    }
}

listaCarrinho.innerHTML += '<li>' + item.nome + ' (x' + item.quantidade +') - ' + formatarPreco(precoTotal) + '<br>' +
    '<button onclick="adicionarAoCarrinhoPorNome(\''+ item.nome + '\')">+</button>' +
    '<button onclick="removerDoCarrinho(\'' + item.nome + '\')">-</button>' + '</li>';

// Calcula o total do carrinho

let total = 0;
for (let i = 0; i < carrinho.length;i++){
    total += carrinho[i].preco * carrinho[i].quantidade;
}

// Atualizar o valor total do carrinho

totalElemento.textContent = formatarPreco(total);
}

//Função auxiliar para adicionar o produto pelo nome
function adicionarAoCarrinhoPorNome(nomeProduto){
    for (let i = 0; i < produto.length; i++){
        if (produtos[i].nome === nomeProduto){
            adicionarAoCarrinho(i);break;
        }
    }
}

// Inicializar pagina

mostrarProdutos();
atualizarCarrinho();

</script>

</body>
</html>